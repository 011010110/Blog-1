**本文主要面试后端Java开发人员，见谅**

# 为什么做单元测试

* 提升重复测试效率
* 提升代码质量
* 提升部署可靠性

# 选型

## JUnit

> 单元测试套件

为什么不使用 TestNG ？在整合 TestNG + Mockito + PowerMock + Spring 时，`@Autowired`的属性会报错，Spring 容器初始化出错，查找资料，基本无解，只好退而求其次，选择 JUnit。从功能强大程度，易用性上，个人较为推荐 TestNG。

## Mockito

> Mock 工具

为什么不使用 JMock 、EasyMock ？因为 API 上更加轻量级，用起来爽爽的。

## PowerMock

> 作为 Mockito 的补充，增加对 `private`、`static`、`final` 的支持。

为什么 Mockito 不自己支持？https://github.com/mockito/mockito/wiki/Mockito-And-Private-Methods 作者有自己的考虑，不过对于使用者，增加了很多整合的痛苦。

# 实践

## Controller 层

以 SpringMVC 举例子



## Service 层

> 方案一：

* 依赖的 Dao 层代码，使用 mock 进行模拟
* 依赖的 Service 层代码，使用 mock 进行模拟

> 方案二：

* 依赖的 Dao 层代码，使用内嵌数据库，例如说 h2database 
* 依赖的 Service 层代码，使用 mock 进行模拟

**个人较为推荐方案二，因为从信任度上，较为真实的模拟了 Dao 层，例如数据插入，可以较为方便的查询，判断Service是否正确设置值，是否有属性漏设置会设置错；当然，该方案在维护上会相对麻烦一些。各有利弊。**

## Dao 层

使用内嵌的数据实现进行测试。

* MySQL ：[h2database](https://github.com/h2database/h2database) 
* MongoDB ：[fongo](https://github.com/fakemongo/fongo)
* Redis ：[embedded-redis](https://github.com/kstyrc/embedded-redis)

# 坑



